package TransacationManagement;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class Transaction {

	public static void main(String[] args) throws ClassNotFoundException, SQLException {
		Class.forName("com.mysql.jdbc.Driver");
		Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/transaction", "root", "root");
		Statement s = con.createStatement();
		ResultSet r=null;
		
		String query = "select id,empName,empLocation,empDesignation from trans where id = 101";
		r = s.executeQuery(query);
		System.out.println("Displaying the data:");
		displayData(r);
		
		con.setAutoCommit(false);
		
		String query1 = "update trans set empName='rajiv' where id = 101";
		int i = s.executeUpdate(query1);
		
		
		Connection con1 = DriverManager.getConnection("jdbc:mysql://localhost:3306/transaction", "root", "root");
		
		
		Statement st = con1.createStatement();
        ResultSet rs;
        rs = st.executeQuery(query); 
        System.out.println("after");
        displayData(rs);
		
        con.setAutoCommit(true;)

	}
	
	
	
	

	public static void displayData(ResultSet rd) throws SQLException {
		while (rd.next()) {
			System.out.println(rd.getInt("id"));
			System.out.println(rd.getString("empName"));
			System.out.println(rd.getString("empLocation"));
			System.out.println(rd.getString("empDesignation"));
		}

	}
}
